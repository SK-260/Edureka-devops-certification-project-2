pipeline{
    agent any
    tools{
        jdk 'JDK 8'
        gradle 'My Gradle'
    }
    stages{
        stage('Delete Workspace'){
            steps{
                deleteDir()
            }              
        }
        stage('Gradle Build'){
            steps{
                git 'https://github.com/SK-260/Edureka-devops-certification-project-2'
                withGradle{
                    sh './gradlew build'
                }
            }
        }
        stage("Build Docker Image"){
            steps{
                script{
                    dockerImage = docker.build("sk260/edureka-project2" + ":$BUILD_NUMBER")
                    // format for this is docker.build(<imagename +:<tagname>, path of dockerfile )
                }
            }
        }
        stage("Push Docker Image"){
            steps{
                script{
                    docker.withRegistry("https://hub.docker.com/repository/docker/sk260/edureka-project2/general","dockerhub_id")
                    // format for this is docker.withRegistry(<registry url>, <registry credentials>)
                    dockerImage.push($BUILD_NUMBER)
                    // format for this is <variable storing details of image>.push(<tag>)
                }
            }
        }
    }
}